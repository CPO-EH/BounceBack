filters:
  # "ip" filter fires only when list contain INGRESS ip adress from list.
  # may be combined with "not" wrapper for allowlist.
  # PARAMS:
  # * list - path to list with ip adresses or/and subnets.
  #
  - name: default_ip_banlist
    type: ip
    params:
      list: data/banned_ips.txt

  - name: default_ip_allowlist
    type: not::ip
    params:
      list: data/allowed_ips.txt

  # "work_time" filter fires only when time of request NOT in work time period.
  # may be combined with "and" filter for more than one work time periods.
  # PARAMS:
  # * from - start of work day in form of HH:mm.
  # * to - end of work day in form of HH:mm.
  # * timezone - timezone of "from" and "to" fields.
  # * weekdays - list of working weekdays, empty == all
  #     may be: Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday
  #
  - name: example_work_time_filter
    type: work_time
    params:
      from: 08:00
      to: 16:00
      timezone: Europe/Moscow
      weekdays:
        # - Monday
        # - Tuesday
        # - Wednesday
        # - Thursday
        # - Friday
        # - Saturday
        # - Sunday

  # "and" filter equals boolean AND.
  # fires only when ALL passed filters fires.
  # PARAMS:
  # * filters - list of filter names above.
  #
  # - name: and_usage_example
  #   type: and
  #   params:
  #     filters:
  #       - default_ip_banlist
  #       - default_ip_allowlist

  # "or" filter equals boolean OR.
  # fires only when ANY passed filter fires.
  # PARAMS:
  # * filters - list of filter names above.
  #
  # - name: or_usage_example
  #   type: or
  #   params:
  #     filters:
  #       - default_ip_banlist
  #       - default_ip_allowlist

  # "not" filter equals boolean NOT.
  # fires only when passed filter NOT fires.
  # may be used as BASE (type: not) filter or WRAPPER filter (type: not::somefiltertype).
  # PARAMS for BASE filter:
  # * filter - filter name from above.
  #
  # - name: not_usage_example
  #   type: not
  #   params:
  #     filter: default_ip_allowlist

proxies:
  - name: example http proxy
    type: http
    listen: 0.0.0.0:5001
    target: http://127.0.0.1:5002
    timeout: 10s
    # tls:
    #   cert: testdata/tls/cert.pem
    #   key: testdata/tls/key.pem
    action: redirect
    action_url: https://www.youtube.com/watch?v=dQw4w9WgXcQ
    filters:
      - default_ip_allowlist
      - default_ip_banlist
      - example_work_time_filter
